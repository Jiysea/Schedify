@model BookingsViewModel

@* All Events *@
@if (Model.BookedEvents.Any())
{
    <div class="grid md:grid-cols-2 xl:grid-cols-3 gap-2 mb-6">
        @foreach (var booking in Model.BookedEvents)
        {
            var venueResource = Model.EventResources.GetValueOrDefault(booking.EventId, null);

            string? fullAddress = venueResource!.ResourceVenue.AddressLine1 + ", " + (venueResource.ResourceVenue.AddressLine2
            != null
            ? venueResource!.ResourceVenue.AddressLine2 + ", " : "") + venueResource!.ResourceVenue.CityMunicipality + ", " +
            venueResource!.ResourceVenue.Province;

            var venueImage = Model.BookingImages.GetValueOrDefault(booking.EventId, "");

            @* 1 Card per Event: Clickable *@
            <div x-on:click="viewBookingModal = !viewBookingModal" hx-get="/attendee/view-booking/@booking.Id"
                hx-target="#viewBookingModalContent" hx-swap="innerHTML"
                class="cursor-pointer flex flex-col items-center gap-4 w-full p-2 rounded-lg border-2 border-zinc-300 hover:border-coffee-300 bg-white hover:bg-coffee-50 duration-200 ease-in-out group">

                @* Resource Image *@
                <span class="flex items-center justify-center w-full h-52">
                    <img class="object-cover w-full h-52 rounded-md" src="/resources/@venueImage" alt="Venue spot">
                </span>

                @* Body *@
                <div class="flex flex-col justify-between gap-2 px-4 w-full">

                    <div class="flex items-center justify-between gap-2">
                        @* Event Name *@
                        <span class="flex items-center gap-1 text-base font-medium text-coffee-900">
                            <svg class="size-6" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 256 256"><path d="M208,32H184V24a8,8,0,0,0-16,0v8H88V24a8,8,0,0,0-16,0v8H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM72,48v8a8,8,0,0,0,16,0V48h80v8a8,8,0,0,0,16,0V48h24V80H48V48ZM208,208H48V96H208V208Zm-38.34-85.66a8,8,0,0,1,0,11.32l-48,48a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L116,164.69l42.34-42.35A8,8,0,0,1,169.66,122.34Z"></path></svg>
                            @booking.Event.ShortName
                        </span>
                        
                        @* Total Amount *@
                        <span class="duration-200 ease-in-out text-sm font-medium px-2 py-1 rounded-md bg-zinc-100 text-zinc-500 group-hover:bg-coffee-100 group-hover:text-coffee-500">
                            â‚±@booking.Event.EntryFee.ToString("N2")
                        </span>
                    </div>

                    @* Statuses *@
                    <div class="flex items-center justify-between gap-2 font-semibold text-xs">
                        @if (booking.Event.Status == EventStatus.Open)
                        {
                            <span class="bg-blue-100 text-blue-500 rounded-md px-2 py-1">
                                OPEN
                            </span>
                        }
                        else if (booking.Event.Status == EventStatus.Ongoing)
                        {
                            <span class="bg-green-100 text-green-500 rounded-md px-2 py-1">
                                ONGOING
                            </span>
                        }
                        else if (booking.Event.Status == EventStatus.Postponed)
                        {
                            <span class="bg-orange-100 text-orange-500 rounded-md px-2 py-1">
                                POSTPONED
                            </span>
                        }
                        else if (booking.Event.Status == EventStatus.Completed)
                        {
                            <span class="bg-indigo-100 text-indigo-500 rounded-md px-2 py-1">
                                COMPLETED
                            </span>
                        }
                        else if (booking.Event.Status == EventStatus.Cancelled)
                        {
                            <span class="bg-red-100 text-red-500 rounded-md px-3 py-1">
                                CANCELLED
                            </span>
                        }

                        @* StartAt Date *@
                        <span
                            class="duration-200 ease-in-out flex items-center justify-center px-2 py-1 rounded-md font-normal text-xs gap-1 bg-zinc-100 group-hover:bg-coffee-100 text-zinc-500 group-hover:text-coffee-500">
                            <svg class="size-4" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 256 256"><path d="M136,80v43.47l36.12,21.67a8,8,0,0,1-8.24,13.72l-40-24A8,8,0,0,1,120,128V80a8,8,0,0,1,16,0Zm-8-48A95.44,95.44,0,0,0,60.08,60.15C52.81,67.51,46.35,74.59,40,82V64a8,8,0,0,0-16,0v40a8,8,0,0,0,8,8H72a8,8,0,0,0,0-16H49c7.15-8.42,14.27-16.35,22.39-24.57a80,80,0,1,1,1.66,114.75,8,8,0,1,0-11,11.64A96,96,0,1,0,128,32Z"></path></svg>

                            @booking.Event.StartAt.ToString("MMM dd (hh:mm tt)") - @booking.Event.EndAt.ToString("MMM dd (hh:mm tt)")
                        </span>
                    </div>

                    <div class="flex items-center justify-start text-xs">
                        @* Full Address *@
                        <span
                            class="duration-200 ease-in-out flex items-center w-full gap-2 px-2 py-1 rounded-md bg-zinc-100 group-hover:bg-coffee-100 text-zinc-500 group-hover:text-coffee-500">
                            <span class="size-4">
                                <svg class="size-4 me-2" xmlns="http://www.w3.org/2000/svg" width="32" height="32"
                                    fill="currentColor" viewBox="0 0 256 256">
                                    <path
                                        d="M112,80a16,16,0,1,1,16,16A16,16,0,0,1,112,80ZM64,80a64,64,0,0,1,128,0c0,59.95-57.58,93.54-60,94.95a8,8,0,0,1-7.94,0C121.58,173.54,64,140,64,80Zm16,0c0,42.2,35.84,70.21,48,78.5,12.15-8.28,48-36.3,48-78.5a48,48,0,0,0-96,0Zm122.77,67.63a8,8,0,0,0-5.54,15C213.74,168.74,224,176.92,224,184c0,13.36-36.52,32-96,32s-96-18.64-96-32c0-7.08,10.26-15.26,26.77-21.36a8,8,0,0,0-5.54-15C29.22,156.49,16,169.41,16,184c0,31.18,57.71,48,112,48s112-16.82,112-48C240,169.41,226.78,156.49,202.77,147.63Z">
                                    </path>
                                </svg>
                            </span>
                            <span class="line-clamp-2 overflow-hidden text-ellipsis">
                                @fullAddress
                            </span>
                        </span>
                    </div>

                </div>

            </div>

            @* Status *@

        }
    </div>
}